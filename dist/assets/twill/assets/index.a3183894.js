import{m as c,b as C,c as f,L as P,F as D,N as s,l as M,n as o,p,q as R}from"./form.3ed58db1.js";import{D as d}from"./language.2baf5859.js";const A="updateModalAction",k="updateModalMode";var u={UPDATE_MODAL_ACTION:A,UPDATE_MODAL_MODE:k},se={props:{nested:{type:Boolean,default:!1},bulkeditable:{type:Boolean,default:!0},emptyMessage:{type:String,default:""}},computed:{rows:{get(){return this.$store.state.datatable.data},set(t){const e=this.rows.length!==t.length;this.$store.commit(d.UPDATE_DATATABLE_DATA,t),this.saveNewTree(e)}},isEmpty:function(){return this.rows.length<=0},isEmptyDatable:function(){return{"datatable__table--empty":this.isEmpty}},...c({columns:t=>t.datatable.columns}),...C(["visibleColumns","hideableColumns","visibleColumnsNames"])},methods:{saveNewTree:function(t){const a=(t?!0:this.nested)?f.SET_DATATABLE_NESTED:f.SET_DATATABLE,n=()=>{this.$store.commit(d.UPDATE_DATATABLE_TRACKER,0),this.$store.dispatch(a)};t?(this.$store.commit(d.UPDATE_DATATABLE_TRACKER,1),this.updateTracker>=2&&n()):n()}}},ce={props:{index:{type:Number,default:0},row:{type:Object,default:function(){return{}}},columns:{type:Array,default:function(){return[]}}},computed:{editInModal:function(){return this.row.hasOwnProperty("editInModal")?this.row.editInModal:!1},editUrl:function(){return this.row.hasOwnProperty("edit")?this.row.edit:"#"},updateUrl:function(){return this.row.updateUrl?this.row.updateUrl:"#"},...c({bulkIds:t=>t.datatable.bulk})},methods:{currentComponent(t){var e;return r+((e=t.specificType)!=null?e:t.name.toLowerCase())},currentComponentProps(t){const e={col:t||{},row:this.row,editUrl:this.editUrl,editInModal:Boolean(this.editInModal)};if(!t)return e;switch(t.name){case"bulk":e.value=this.row.id,e.initialValue=this.bulkIds;break;case"languages":e.languages=this.row.hasOwnProperty("languages")?this.row.languages:[],e.editUrl=this.editUrl;break;case"publish_start_date":e.startDate="",e.endDate="";break}return e},editInPlace:function(t){if(t.lang){const e=t.lang;this.$store.commit(P.UPDATE_LANG,e.value)}if(this.editInModal){const e=this.editInModal;this.$store.commit(u.UPDATE_MODAL_MODE,"update"),this.$store.commit(u.UPDATE_MODAL_ACTION,this.updateUrl),this.$store.commit(D.UPDATE_FORM_LOADING,!0),this.$store.dispatch(f.REPLACE_FORM,e).then(()=>{this.$nextTick(function(){this.$root.$refs.editionModal&&this.$root.$refs.editionModal.open()})},a=>{this.$store.commit(s.SET_NOTIF,{message:"Your content can not be edited, please retry",variant:"error"})})}},cellClasses:function(t,e){return{[e+"--icon"]:t.name==="featured"||t.name==="published",[e+"--bulk"]:t.name==="bulk",[e+"--thumb"]:t.name==="thumbnail",[e+"--draggable"]:t.name==="draggable",[e+"--languages"]:t.name==="languages",[e+"--nested"]:t.name==="nested",[e+"--nested--parent"]:t.name==="nested"&&this.nestedDepth===0,[e+"--name"]:t.name==="name"}},isSpecificColumn:function(t){var e;return Xt.includes((e=t.specificType)!=null?e:t.name)},tableCellUpdate:function(t){switch(t.col){case"published":this.togglePublish(t.row);break;case"bulk":this.toggleBulk(t.row);break;case"featured":this.toggleFeatured(t.row);break}},toggleFeatured:function(t){t.hasOwnProperty("deleted")?this.$store.commit(s.SET_NOTIF,{message:"You can\u2019t feature/unfeature a deleted item, please restore it first.",variant:"error"}):this.$store.dispatch(f.TOGGLE_FEATURE,t)},toggleBulk:function(t){this.$store.commit(d.UPDATE_DATATABLE_BULK,t.id)},togglePublish:function(t){t.hasOwnProperty("deleted")?this.$store.commit(s.SET_NOTIF,{message:"You can\u2019t publish/unpublish a deleted item, please restore it first.",variant:"error"}):this.$store.dispatch(f.TOGGLE_PUBLISH,t)},restoreRow:function(t){this.$store.dispatch(f.RESTORE_ROW,t)},destroyRow:function(t){this.$root.$refs.warningDestroyRow?this.$root.$refs.warningDestroyRow.open(()=>{this.$store.dispatch(f.DESTROY_ROW,t)}):this.$store.dispatch(f.DESTROY_ROW,t)},deleteRow:function(t){this.$root.$refs.warningDeleteRow?this.$root.$refs.warningDeleteRow.open(()=>{this.$store.dispatch(f.DELETE_ROW,t)}):this.$store.dispatch(f.DELETE_ROW,t)},duplicateRow:function(t){this.$store.dispatch(f.DUPLICATE_ROW,t)}}},pe={filters:M,computed:{...c({currentLocale:t=>t.language.active})},methods:{formatPermalink:function(t){const e=this.$refs.permalink;if(!!e&&t){let a="";t.value&&typeof t.value=="string"?a=t.value:typeof t=="string"&&(a=t);const n=this.$options.filters.slugify(a),l={name:e.attributes?e.attributes.name:e.name,value:n};t.locale?l.locale=t.locale:l.locale=this.currentLocale.value,this.$store.commit(D.UPDATE_FORM_FIELD,l)}}}},i={props:{col:{type:Object,default:()=>{}},row:{type:Object,default:()=>{}},editUrl:{type:String,default:"#"},editInModal:{type:Boolean,default:!1}},computed:{colName:function(){return this.col.hasOwnProperty("name")?this.col.name:""}},methods:{update:function(){this.$emit("update",{row:this.row,col:this.colName})},preventEditInPlace:function(t){this.editInModal&&t.preventDefault(),this.editInPlace()},editInPlace:function(t,e){this.$emit("editInPlace",{event:t,lang:e})},restoreRow:function(){this.$emit("restoreRow",this.row)},destroyRow:function(){this.$emit("destroyRow",this.row)},deleteRow:function(){this.$emit("deleteRow",this.row)},duplicateRow:function(){this.$emit("duplicateRow",this.row)}}},E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a17-dropdown",{ref:"rowSetupDropdown",attrs:{position:"bottom-right",fixed:!0}},[a("a17-button",{attrs:{variant:"icon"},on:{click:function(n){return t.$refs.rowSetupDropdown.toggle()}}},[a("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"more-dots"}})]),a("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},[t.row.hasOwnProperty("permalink")?a("a",{attrs:{href:t.row.permalink,target:"_blank"}},[t._v("View permalink")]):t._e(),t.row.hasOwnProperty("edit")&&!t.row.hasOwnProperty("deleted")&&t.row.edit?a("a",{attrs:{href:t.editUrl},on:{click:function(n){return t.preventEditInPlace(n)}}},[t._v(t._s(t.$trans("listing.dropdown.edit","Edit")))]):t._e(),t.row.hasOwnProperty("published")&&!t.row.hasOwnProperty("deleted")?a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.update("published")}}},[t._v(t._s(t.row.published?t.$trans("listing.dropdown.unpublish","Unpublish"):t.$trans("listing.dropdown.publish","Publish")))]):t._e(),t.row.hasOwnProperty("featured")&&!t.row.hasOwnProperty("deleted")?a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.update("featured")}}},[t._v(t._s(t.row.featured?t.$trans("listing.dropdown.unfeature","Unfeature"):t.$trans("listing.dropdown.feature","Feature")))]):t._e(),t.row.duplicate&&!t.row.hasOwnProperty("deleted")?a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.duplicateRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.duplicate","Duplicate")))]):t._e(),t.row.hasOwnProperty("deleted")?a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.restoreRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.restore","Restore")))]):t._e(),t.row.hasOwnProperty("deleted")&&t.row.hasOwnProperty("destroyable")?a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.destroyRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.destroy","Destroy")))]):t.row.delete&&!t.row.hasOwnProperty("deleted")?a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.deleteRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.delete","Delete")))]):t._e()])],1)},B=[];const O={name:"TableCellActions",mixins:[i],methods:{update:function(t){this.$emit("update",{row:this.row,col:t})}}},m={};var N=o(O,E,B,!1,L,"ba47528a",null,null);function L(t){for(let e in m)this[e]=m[e]}var U=function(){return N.exports}(),F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.toggleBulk(n)}}},[a("a17-checkbox",{attrs:{name:"bulkEdit",value:t.value,initialValue:t.initialValue}})],1)},S=[];const j={name:"A17TableCellBulk",mixins:[i],components:{},props:{value:{type:Number,required:!0},initialValue:{type:Array,required:!0}},methods:{toggleBulk:function(){this.update()}}},w={};var G=o(j,F,S,!1,W,"838e9446",null,null);function W(t){for(let e in w)this[e]=w[e]}var q=function(){return G.exports}(),H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t.formatDateLabel.length>0?a("span",{staticClass:"tablecell__datePub",class:{"s--expired":t.formatDateLabel===t.textExpired}},[t._v(" "+t._s(t._f("formatDatatableDate")(t.startDate))+" "),t.endDate?[t._v("- "+t._s(t._f("formatDatatableDate")(t.endDate)))]:t._e(),a("br"),a("span",[t._v(t._s(t.formatDateLabel))])],2):a("span",[t.startDate?[t._v(" "+t._s(t._f("formatDatatableDate")(t.startDate))+" ")]:[t._v(" \u2014 ")]],2)])},Y=[];const K={name:"A17TableCellDates",mixins:[i],data(){return{textExpired:this.$trans("publisher.expired"),textScheduled:this.$trans("publisher.scheduled")}},computed:{formatDateLabel:function(){let t="";const e=p(this.startDate,new Date),a=this.endDate?p(this.endDate,new Date):1;return this.startDate&&a<0?t=this.textExpired:e>0&&(t=this.textScheduled),t},startDate:function(){return this.row.hasOwnProperty("publish_start_date")?this.row.publish_start_date:""},endDate:function(){return this.row.hasOwnProperty("publish_end_date")?this.row.publish_end_date:""}},filters:M},h={};var Q=o(K,H,Y,!1,z,"602b7452",null,null);function z(t){for(let e in h)this[e]=h[e]}var J=function(){return Q.exports}(),X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.row.hasOwnProperty("featured")?a("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"tablecell__feature",class:{"tablecell__feature--active":t.row[t.colName]},attrs:{"data-tooltip-title":t.row.featured?"Unfeature":"Feature"},on:{click:function(n){return n.preventDefault(),t.toggleFeatured(n)}}},[a("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"star-feature_active"}}),a("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"star-feature"}})]):t._e()},Z=[];const V={name:"A17TableCellFeatured",mixins:[i],methods:{toggleFeatured:function(){this.update()}}},_={};var tt=o(V,X,Z,!1,et,"83779ce6",null,null);function et(t){for(let e in _)this[e]=_[e]}var at=function(){return tt.exports}(),nt=function(t,e){var a=e._c;return a("span",{staticClass:"tablecell__handle"})},ot=[];const it={name:"A17TableCellDraggable",mixins:[i]},x={};var rt=o(it,nt,ot,!0,ft,"37de210b",null,null);function ft(t){for(let e in x)this[e]=x[e]}var lt=function(){return rt.exports}(),dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t._l(t.displayedLanguages,function(n){return a("a",{key:n.value,staticClass:"tag tag--disabled",class:{"tag--enabled":n.published},attrs:{href:t.editWithLanguage(n)},on:{click:function(l){return t.editInPlace(l,n)}}},[t._v(" "+t._s(n.shortlabel)+" ")])}),t.languages.length>4?a("a",{staticClass:"more__languages f--small",attrs:{href:t.editWithLanguage(t.languages[0])},on:{click:function(n){return t.editInPlace(n,t.languages[0])}}},[t._v(" + "+t._s(t.languages.length-4)+" more ")]):t._e()],2)},st=[];const ct={name:"A17TableCellLanguages",mixins:[i],props:{languages:{type:Array,default:function(){return[]}}},computed:{displayedLanguages:function(){return this.languages.slice(0,4)}},methods:{editWithLanguage:function(t){const e={};return e.lang=t.value,this.editWithQuery(e)},editWithQuery:function(t){const e=[];for(const n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));const a=e.length?"?"+e.join("&"):"";return this.editUrl!=="#"?this.editUrl+a:this.editUrl},editInPlace:function(t,e){this.$emit("editInPlace",t,e)}}},g={};var pt=o(ct,dt,st,!1,ut,"a31d909c",null,null);function ut(t){for(let e in g)this[e]=g[e]}var mt=function(){return pt.exports}(),wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.row.hasOwnProperty("published")?a("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"tablecell__pubstate",class:{"tablecell__pubstate--live":t.row[t.colName]},attrs:{"data-tooltip-title":t.row.published?"Unpublish":"Publish"},on:{click:function(n){return n.preventDefault(),t.togglePublish(n)}}}):t._e()},ht=[];const _t={name:"A17TableCellPublished",mixins:[i],methods:{togglePublish:function(){this.update()}}},v={};var xt=o(_t,wt,ht,!1,gt,"4bcef49c",null,null);function gt(t){for(let e in v)this[e]=v[e]}var vt=function(){return xt.exports}(),bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return!t.row.hasOwnProperty("deleted")&&t.row.edit?a("a",{staticClass:"tablecell__name",attrs:{href:t.editUrl},on:{click:function(n){return t.preventEditInPlace(n)}}},[a("span",{staticClass:"f--link-underlined--o"},[t._v(t._s(t.row[t.colName]))])]):a("span",[t._v(t._s(t.row[t.colName]))])},yt=[];const It={name:"A1TableCellName",mixins:[i]},b={};var $t=o(It,bt,yt,!1,Tt,"49d31086",null,null);function Tt(t){for(let e in b)this[e]=b[e]}var Dt=function(){return $t.exports}(),Mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tablecell__raw",domProps:{innerHTML:t._s(t.row[t.colName])}})},Ct=[];const Pt={name:"A1TableCellHtml",mixins:[i]},y={};var Rt=o(Pt,Mt,Ct,!1,At,null,null,null);function At(t){for(let e in y)this[e]=y[e]}var kt=function(){return Rt.exports}(),Et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.colName==="name"?a("a17-table-cell-name",t._b({on:{update:t.update,editInPlace:t.editInPlace}},"a17-table-cell-name",t.childProps,!1)):t.col.hasOwnProperty("html")?a("a17-table-cell-html",t._b({on:{update:t.update,editInPlace:t.editInPlace}},"a17-table-cell-html",t.childProps,!1)):a("span",[t._v(t._s(t.row[t.colName]))])},Bt=[];const Ot={name:"A17TableCellGeneric",mixins:[i],computed:{childProps:function(){return this.$props}},components:{"a17-table-cell-name":Dt,"a17-table-cell-html":kt}},I={};var Nt=o(Ot,Et,Bt,!1,Lt,"91f81956",null,null);function Lt(t){for(let e in I)this[e]=I[e]}var Ut=function(){return Nt.exports}(),Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"tablecell__nested-depth",style:t.cellWidth})},St=[];const jt={name:"A17TableCellNested",mixins:[i],props:{depth:{type:Number,default:0},offset:{type:Number,default:0}},computed:{cellWidth(){return this.depth>0?{width:this.depth*80-20-this.offset+"px"}:""}}},$={};var Gt=o(jt,Ft,St,!1,Wt,"7153bbba",null,null);function Wt(t){for(let e in $)this[e]=$[e]}var qt=function(){return Gt.exports}(),Ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.getThumbClasses},[a("a",{attrs:{href:t.row.hasOwnProperty("deleted")?!1:t.editUrl},on:{click:function(n){t.row.hasOwnProperty("deleted")||t.preventEditInPlace(n)}}},[t.col.variation==="rounded"?[a("a17-avatar",{attrs:{name:t.rowTitle,thumbnail:t.row[t.colName]}})]:[a("img",{attrs:{src:t.row[t.colName]}})]],2)])},Yt=[];const Kt={name:"A17TableCellThumbNail",mixins:[i],components:{"a17-avatar":R},computed:{rowTitle(){var t,e;return(e=(t=this.row.name)!=null?t:this.row.title.replace(/<[^>]*>?/gm,""))!=null?e:""},getThumbClasses(){return["tablecell__thumb",this.col.variation?`tablecell__thumb--${this.col.variation}`:""]}}},T={};var Qt=o(Kt,Ht,Yt,!1,zt,"6360cc5f",null,null);function zt(t){for(let e in T)this[e]=T[e]}var Jt=function(){return Qt.exports}();const Xt=["draggable","bulk","languages","featured","published","thumbnail","publish_start_date","nested"],r="a17-table-cell-",Zt=U,Vt=q,te=J,ee=at,ae=lt,ne=mt,oe=vt,ie=Ut,re=qt,fe=Jt;var ue={[r+"actions"]:Zt,[r+"bulk"]:Vt,[r+"publish_start_date"]:te,[r+"featured"]:ee,[r+"draggable"]:ae,[r+"generic"]:ie,[r+"languages"]:ne,[r+"published"]:oe,[r+"nested"]:re,[r+"thumbnail"]:fe};export{ce as D,pe as F,u as M,ne as T,ue as a,se as b};
