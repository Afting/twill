import{n as s,m as l,b as $,a8 as S,d as T,D as u,O as R,c as i,L as P,F as p,N as U,f as m,h as F,i as O,s as r,j as N,a as W,o as G,k as K}from"./form.af977733.js";import{D as E,a as C,b as h,M as f,F as z}from"./index.735893e9.js";import{D as d,l as V}from"./language.bdacb39e.js";import{a as j}from"./Paginate.30894ad4.js";import{r as H,a as Y,c as X,b as J}from"./attributes.d3935126.js";import{d as q,g as w}from"./datatable.058b61f9.js";import"./toggleVisibility.ff8a4ceb.js";import"./pushState.5b409387.js";var M={props:{nested:{type:Boolean,default:!1},maxDepth:{type:Number,default:1},depth:{type:Number,default:0},name:{type:String,default:"group1"},parentId:{type:Number,default:-1}},data(){return{currentElDepth:void 0}},computed:{updateTracker(){return this.$store.state.datatable.updateTracker},draggableGetComponentData:function(){return{props:{depth:this.depth}}}}},Q=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"table__scroller",on:{scroll:t.updateScroll}},[e("table",{staticClass:"table",class:{"table--sized":t.columnsWidth.length}},[t.columnsWidth.length?e("colgroup",t._l(t.columnsWidth,function(n,o){return e("col",{key:o,style:t.colWidths[o]})}),0):t._e(),t._t("default")],2)])},Z=[];const tt={name:"A17Table",props:{xScroll:{type:Number,default:1},columnsWidth:{type:Array,default:function(){return[]}}},data:function(){return{currentScroll:this.xScroll}},computed:{colWidths:function(){return this.columnsWidth.map(function(t){return{width:t?t+"px":""}})}},watch:{xScroll:function(t){this.currentScroll!==t&&(this.currentScroll=t,this.$el.scrollLeft=t)}},methods:{updateScroll:function(){const t=this.$el.scrollLeft;this.currentScroll!==t&&(this.currentScroll=t,this.$emit("scroll",t))}}},b={};var et=s(tt,Q,Z,!1,at,"0fa07b31",null,null);function at(t){for(let a in b)this[a]=b[a]}var B=function(){return et.exports}(),nt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("tr",{staticClass:"tablehead"},[t._l(t.columns,function(n){return e("td",{key:n.name,staticClass:"tablehead__cell f--small",class:t.cellClasses(n),on:{click:function(o){return t.sortColumn(n)}}},[t.isDisplayedColumn(n)?e("span",[t._v(t._s(n.label)+" "),e("span",{staticClass:"tablehead__arrow"},[t._v("\u2193")])]):t._e(),n.name==="bulk"?e("a",{attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),o.stopPropagation(),t.toggleBulkSelect()}}},[e("span",[e("a17-checkbox",{class:{"checkbox--minus":t.checkboxMinus},attrs:{name:"bulkAll",value:1,initialValue:t.bulkValue}})],1)]):t._e()])}),e("td",{staticClass:"tablehead__spacer"})],2)},dt=[];const it={name:"A17Tablehead",props:{sortable:{type:Boolean,default:!0},columns:{type:Array,default:function(){return[]}}},data:function(){return{currentSort:"name",currentDirection:"asc"}},computed:{bulkValue:function(){return this.bulkIds.length?1:0},checkboxMinus:function(){return this.bulkIds.length>0&&this.bulkIds.length!==this.dataIds.length},...l({bulkIds:t=>t.datatable.bulk,sortKey:t=>t.datatable.sortKey,sortDir:t=>t.datatable.sortDir}),...$(["dataIds"])},methods:{cellClasses:function(t){return[t.name==="featured"||t.name==="published"?"tablehead__cell--icon":"",t.name==="thumbnail"?"tablehead__cell--thumb":"",t.name==="thumbnail"&&t.variation&&t.variation==="rounded"?"tablehead__cell--thumb-rounded":"",t.name==="draggable"?"tablehead__cell--draggable":"",t.name==="nested"?"tablehead__cell--nested":"",t.name==="bulk"?"tablehead__cell--bulk":"",t.sortable&&this.sortable?"tablehead__cell--sortable":"",t.name===this.sortKey?"tablehead__cell--sorted":"",t.name===this.sortKey&&this.sortDir?`tablehead__cell--sorted${this.sortDir}`:""]},isDisplayedColumn:function(t){return t.name!=="draggable"&&t.name!=="featured"&&t.name!=="nested"&&t.name!=="bulk"&&t.name!=="published"&&t.name!=="thumbnail"},sortColumn:function(t){t.sortable&&this.sortable&&this.$emit("sortColumn",t)},toggleBulkSelect:function(){const t=this.bulkIds.length?[]:this.dataIds;this.$store.commit(d.REPLACE_DATATABLE_BULK,t)}}},_={};var ot=s(it,nt,dt,!1,st,"da0e38d8",null,null);function st(t){for(let a in _)this[a]=_[a]}var L=function(){return ot.exports}(),lt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("tr",{staticClass:"tablerow"},[t._l(t.columns,function(n){return e("td",{key:n.name,staticClass:"tablecell",class:t.cellClasses(n,"tablecell"),style:t.nestedStyle(n)},[t.isSpecificColumn(n)?[e(t.currentComponent(n),t._b({tag:"component",attrs:{row:t.row},on:{update:t.tableCellUpdate,editInPlace:t.editInPlace}},"component",t.currentComponentProps(n),!1))]:e("a17-table-cell-generic",t._b({attrs:{row:t.row},on:{editInPlace:t.editInPlace,update:t.tableCellUpdate}},"a17-table-cell-generic",t.currentComponentProps(n),!1))],2)}),e("td",{staticClass:"tablecell tablecell--spacer"}),e("td",{staticClass:"tablecell tablecell--sticky"},[t.row.edit?e("a17-table-cell-actions",t._b({on:{editInPlace:t.editInPlace,update:t.tableCellUpdate,restoreRow:t.restoreRow,destroyRow:t.destroyRow,deleteRow:t.deleteRow,duplicateRow:t.duplicateRow}},"a17-table-cell-actions",t.currentComponentProps(),!1)):t._e()],1)],2)},rt=[];const ft={name:"A17Tablerow",mixins:[E],components:{...C},props:{draggable:{type:Boolean,default:!1},nestedDepth:{type:Number,default:0},rowType:{type:String,default:""}},computed:{nestedOffset(){return this.columns.find(t=>t.name==="draggable")?10:0}},methods:{nestedStyle(t){return this.columns.find(a=>a.name==="nested")&&t.name==="draggable"?{"webkit-transform":"translateX(-"+this.nestedDepth*80+"px)",transform:"translateX(-"+this.nestedDepth*80+"px)"}:""}}},g={};var ct=s(ft,lt,rt,!1,pt,"513d9bc7",null,null);function pt(t){for(let a in g)this[a]=g[a]}var ut=function(){return ct.exports}(),mt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"sticky",rawName:"v-sticky"}],staticClass:"datatable",attrs:{"data-sticky-id":"thead","data-sticky-offset":"0"}},[e("div",{staticClass:"datatable__sticky",attrs:{"data-sticky-top":"thead"}},[e("div",{staticClass:"datatable__stickyHead",attrs:{"data-sticky-target":"thead"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"datatable__stickyInner"},[e("div",{staticClass:"datatable__setup"},[t.hideableColumns.length?e("a17-dropdown",{ref:"setupDropdown",staticClass:"datatable__setupDropdown",attrs:{position:"bottom-right",title:t.$trans("listing.columns.show"),clickable:!0,offset:-10}},[e("button",{staticClass:"datatable__setupButton",on:{click:function(n){return t.$refs.setupDropdown.toggle()}}},[e("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"preferences"}})]),e("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},[e("a17-checkboxgroup",{attrs:{name:"visibleColumns",options:t.checkboxesColumns,selected:t.visibleColumnsNames,min:2},on:{change:t.updateActiveColumns}})],1)]):t._e()],1),e("div",{staticClass:"datatable__stickyTable"},[e("a17-table",{attrs:{columnsWidth:t.columnsWidth,xScroll:t.xScroll},on:{scroll:t.updateScroll}},[e("thead",[e("a17-tablehead",{attrs:{columns:t.visibleColumns},on:{sortColumn:t.updateSort}})],1)])],1)])])])]),e("div",{staticClass:"container"},[e("div",{staticClass:"datatable__table",class:t.isEmptyDatable},[e("a17-table",{attrs:{xScroll:t.xScroll},on:{scroll:t.updateScroll}},[e("thead",[e("a17-tablehead",{ref:"thead",attrs:{columns:t.visibleColumns}})],1),t.draggable?[e("draggable",{staticClass:"datatable__drag",attrs:{tag:"tbody",options:t.dragOptions},model:{value:t.rows,callback:function(n){t.rows=n},expression:"rows"}},[t._l(t.rows,function(n,o){return[e("a17-tablerow",{key:n.id,attrs:{row:n,index:o,columns:t.visibleColumns}})]})],2)]:e("tbody",[t._l(t.rows,function(n,o){return[e("a17-tablerow",{key:n.id,attrs:{row:n,index:o,columns:t.visibleColumns}})]})],2)],2),t.rows.length<=0?[e("div",{staticClass:"datatable__empty"},[e("h4",[t._v(t._s(t.emptyMessage))])])]:t._e(),t.maxPage>1||t.initialMaxPage>t.maxPage&&!t.isEmpty?e("a17-paginate",{attrs:{max:t.maxPage,value:t.page,offset:t.offset,availableOffsets:[t.initialOffset,t.initialOffset*3,t.initialOffset*6]},on:{changePage:t.updatePage,changeOffset:t.updateOffset}}):t._e()],2)]),t.loading?e("a17-spinner",[t._v("Loading\u2026")]):t._e()],1)},ht=[];const wt={name:"A17Datatable",components:{"a17-table":B,"a17-tablehead":L,"a17-tablerow":ut,"a17-paginate":j,"a17-spinner":S,draggable:T},mixins:[h,u],data:function(){return{handle:".tablecell__handle",reorderable:!this.draggable,xScroll:0,columnsWidth:[]}},computed:{checkboxesColumns:function(){const t=[];return this.hideableColumns.length&&this.hideableColumns.forEach(function(a){t.push({value:a.name,label:a.label})}),t},...l({page:t=>t.datatable.page,offset:t=>t.datatable.offset,maxPage:t=>t.datatable.maxPage,initialOffset:t=>t.datatable.defaultOffset,initialMaxPage:t=>t.datatable.defaultMaxPage,loading:t=>t.datatable.loading})},methods:{getColumnWidth:function(){const t=this,a=[],e=t.$refs.thead.$el.children;for(let n=0;n<e.length;n++)a.push(e[n].offsetWidth);t.columnsWidth=a},updateScroll:function(t){this.xScroll=t},resize:R(function(){this.getColumnWidth()},100),initEvents:function(){const t=this;window.addEventListener("resize",()=>t.resize()),t.resize()},disposeEvents:function(){const t=this;window.removeEventListener("resize",t.resize())},updateSort:function(t){!t.sortable||(this.reorderable&&(this.reorderable=!1,this.$store.commit(d.REMOVE_DATATABLE_COLUMN,"draggable")),this.$store.commit(d.UPDATE_DATATABLE_PAGE,1),this.$store.commit(d.UPDATE_DATATABLE_SORT,t),this.$store.dispatch(i.GET_DATATABLE))},updateOffset:function(t){this.$store.commit(d.UPDATE_DATATABLE_PAGE,1),this.$store.commit(d.UPDATE_DATATABLE_OFFSET,t),this.$store.dispatch(i.GET_DATATABLE)},updatePage:function(t){t!==this.page&&(this.$store.commit(d.UPDATE_DATATABLE_PAGE,t),this.$store.dispatch(i.GET_DATATABLE))},updateActiveColumns:function(t){this.$store.commit(d.UPDATE_DATATABLE_VISIBLITY,t),this.$nextTick(function(){this.getColumnWidth()}),this.$store.dispatch(i.GET_DATATABLE)}},watch:{loading:function(){this.$nextTick(function(){this.getColumnWidth()})}},beforeMount:function(){function t(e){return e.name==="bulk"}function a(e){return e.name==="draggable"}this.bulkeditable&&(this.columns.find(t)||this.$store.commit(d.ADD_DATATABLE_COLUMN,{index:0,data:{name:"bulk",label:"",visible:!0,optional:!1,sortable:!1}})),this.draggable&&(this.columns.find(a)||this.$store.commit(d.ADD_DATATABLE_COLUMN,{index:0,data:{name:"draggable",label:"",visible:!0,optional:!1,sortable:!1}}))},mounted:function(){this.initEvents()},beforeDestroy:function(){this.disposeEvents()}},x={};var bt=s(wt,mt,ht,!1,_t,"7197d651",null,null);function _t(t){for(let a in x)this[a]=x[a]}var gt=function(){return bt.exports}(),xt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"nested-item"},[t._l(t.columns,function(n){return e("span",{key:n.name,staticClass:"nested-item__cell",class:t.cellClasses(n,"nested-item__cell")},[t.isSpecificColumn(n)?[e(t.currentComponent(n.name),t._b({tag:"component",on:{update:t.tableCellUpdate,editInPlace:t.editInPlace}},"component",t.currentComponentProps(n),!1))]:e("a17-table-cell-generic",t._b({on:{editInPlace:t.editInPlace,update:t.tableCellUpdate}},"a17-table-cell-generic",t.currentComponentProps(n),!1))],2)}),e("span",{staticClass:"nested-item__cell nested-item__cell--actions"},[e("a17-table-cell-actions",t._b({on:{editInPlace:t.editInPlace,update:t.tableCellUpdate,restoreRow:t.restoreRow,deleteRow:t.deleteRow,destroyRow:t.destroyRow,duplicateRow:t.duplicateRow}},"a17-table-cell-actions",t.currentComponentProps(),!1))],1)],2)},vt=[];const yt={name:"A17-nested-item",mixins:[E],components:{...C}},v={};var It=s(yt,xt,vt,!1,kt,"6bdd9dce",null,null);function kt(t){for(let a in v)this[a]=v[a]}var At=function(){return It.exports}(),Dt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("draggable",{staticClass:"nested__dropArea",class:t.nestedDropAreaClasses,attrs:{options:t.draggableOptions,tag:"ul","component-data":t.draggableGetComponentData},model:{value:t.rows,callback:function(n){t.rows=n},expression:"rows"}},t._l(t.rows,function(n,o){return e("li",{key:t.depth+"-"+n.id,staticClass:"nested-datatable__item",class:t.haveChildren(n.children)},[e("a17-nested-item",{attrs:{index:o,row:n,columns:t.columns}}),n.children&&t.depth<t.maxDepth?e("a17-nested-list",{attrs:{maxDepth:t.maxDepth,depth:t.depth+1,parentId:n.id,items:n.children,nested:!0,draggable:!0}}):t._e()],1)}),0)},$t=[];const Tt={name:"a17-nested-list",components:{"a17-nested-item":At,draggable:T},mixins:[h,u,M],props:{index:{type:Number,default:0},items:{type:Array,default:()=>[]}},data:function(){return{handle:".tablecell__handle"}},computed:{styleDepth:function(){return{marginLeft:this.depth===0?"0px":"60px"}},rows:{get(){return this.parentId>-1?this.items:this.$store.state.datatable.data},set(t){const a={parentId:this.parentId,val:t},e=this.rows.length!==a.val.length;this.parentId>-1?this.$store.commit(d.UPDATE_DATATABLE_NESTED,a):this.$store.commit(d.UPDATE_DATATABLE_DATA,t),this.saveNewTree(e)}},nestedDropAreaClasses:function(){return[this.rows.length===0?"nested__dropArea--empty":"",this.depth?`nested__dropArea--depth nested__dropArea--depth${Math.min(10,this.depth)}`:""]},draggableOptions:function(){return{...this.dragOptions,fallbackTolerance:5,group:{name:this.name}}}},methods:{haveChildren:function(t){return{"nested-datatable__item--empty":(t||[]).length===0&&this.depth<this.maxDepth}}}},y={};var Et=s(Tt,Dt,$t,!1,Ct,"336177dd",null,null);function Ct(t){for(let a in y)this[a]=y[a]}var Mt=function(){return Et.exports}(),Bt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"nested-datatable"},[e("div",{staticClass:"container"},[e("div",{staticClass:"datatable__table"},[e("a17-table",[e("thead",[e("a17-tablehead",{ref:"thead",attrs:{columns:t.visibleColumns}})],1)])],1)]),e("div",{staticClass:"container"},[e("div",{staticClass:"nested-datatable__table"},[e("a17-nested-list",{attrs:{nested:!0,maxDepth:t.maxDepth,draggable:t.draggable}})],1)])])},Lt=[];const St={name:"A17NestedDatatable",mixins:[h,u,M],data:function(){return{items:this.$store.state.datatable.data}},components:{"a17-table":B,"a17-tablehead":L,"a17-nested-list":Mt},beforeMount:function(){function t(e){return e.name==="bulk"}function a(e){return e.name==="draggable"}this.bulkeditable&&(this.columns.find(t)||this.$store.commit(d.ADD_DATATABLE_COLUMN,{index:0,data:{name:"bulk",label:"",visible:!0,optional:!1,sortable:!1}})),this.draggable&&(this.columns.find(a)||this.$store.commit(d.ADD_DATATABLE_COLUMN,{index:0,data:{name:"draggable",label:"",visible:!0,optional:!1,sortable:!1}}))}},I={};var Rt=s(St,Bt,Lt,!1,Pt,"966be590",null,null);function Pt(t){for(let a in I)this[a]=I[a]}var Ut=function(){return Rt.exports}(),Ft=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("ul",{staticClass:"secondarynav secondarynav--desktop",attrs:{slot:"navigation"},slot:"navigation"},t._l(t.navFilters,function(n,o){return e("li",{key:o,staticClass:"secondarynav__item",class:{"s--on":t.navActive===n.slug}},[e("a",{attrs:{href:"#"},on:{click:function(c){return c.preventDefault(),t.filterStatus(n.slug)}}},[e("span",{staticClass:"secondarynav__link"},[t._v(t._s(n.name))]),n.number!==null?e("span",{staticClass:"secondarynav__number"},[t._v("("+t._s(n.number)+")")]):t._e()])])}),0),t.navFilters.length&&t.selectedNav?e("div",{staticClass:"secondarynav secondarynav--mobile secondarynav--dropdown",attrs:{slot:"navigation"},slot:"navigation"},[e("a17-dropdown",{ref:"secondaryNavDropdown",attrs:{position:"bottom-left",width:"full",offset:0}},[e("a17-button",{staticClass:"secondarynav__button",attrs:{variant:"dropdown-transparent",size:"small"},on:{click:function(n){return t.$refs.secondaryNavDropdown.toggle()}}},[e("span",{staticClass:"secondarynav__link"},[t._v(t._s(t.selectedNav.name))]),e("span",{staticClass:"secondarynav__number"},[t._v("("+t._s(t.selectedNav.number)+")")])]),e("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},[e("ul",t._l(t.navFilters,function(n,o){return e("li",{key:o,staticClass:"secondarynav__item"},[e("a",{attrs:{href:"#"},on:{click:function(c){return c.preventDefault(),t.filterStatus(n.slug)}}},[e("span",{staticClass:"secondarynav__link"},[t._v(t._s(n.name))]),n.number!==null?e("span",{staticClass:"secondarynav__number"},[t._v("("+t._s(n.number)+")")]):t._e()])])}),0)])],1)],1):t._e()])},Ot=[];const Nt={name:"A17TableFilters",data:function(){return{navFilters:this.$store.state.datatable.filtersNav}},computed:{selectedNav:function(){const t=this.navFilters.filter(a=>a.slug===this.navActive);return t.length>0?t[0]:null},...l({navActive:t=>t.datatable.filter.status})},methods:{filterStatus:function(t){this.navActive!==t&&(this.$store.commit(d.UPDATE_DATATABLE_PAGE,1),this.$store.commit(d.UPDATE_DATATABLE_FILTER_STATUS,t),this.$store.dispatch(i.GET_DATATABLE))}}},k={};var Wt=s(Nt,Ft,Ot,!1,Gt,null,null,null);function Gt(t){for(let a in k)this[a]=k[a]}var Kt=function(){return Wt.exports}(),zt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"bulkEditor"},[t.bulkIds.length?e("div",{staticClass:"bulkEditor__inner"},[e("div",{staticClass:"container"},[e("p",{staticClass:"bulkEditor__infos"},[t._v(" "+t._s(t.bulkIds.length)+" "+t._s(t.bulkIds.length>1?t.$trans("listing.bulk-selected-items"):t.$trans("listing.bulk-selected-item"))+" ")]),e("div",{staticClass:"bulkEditor__dropdown"},[e("a17-dropdown",{ref:"bulkActionsDown",attrs:{position:"bottom-left",width:"full",offset:0}},[e("a17-button",{attrs:{variant:"dropdown",size:"small"},on:{click:function(n){return t.$refs.bulkActionsDown.toggle()}}},[t._v(t._s(t.$trans("listing.bulk-actions")))]),e("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},[e("ul",[e("li",[t.bulkPublishable()?e("button",{on:{click:t.bulkPublish}},[t._v(t._s(t.$trans("listing.dropdown.publish")))]):t._e(),t.bulkPublishable(!0)?e("button",{on:{click:t.bulkUnpublish}},[t._v(t._s(t.$trans("listing.dropdown.unpublish")))]):t._e(),t.bulkFeaturable()?e("button",{on:{click:t.bulkFeature}},[t._v(t._s(t.$trans("listing.dropdown.feature")))]):t._e(),t.bulkFeaturable(!0)?e("button",{on:{click:t.bulkUnFeature}},[t._v(t._s(t.$trans("listing.dropdown.unfeature")))]):t._e(),t.bulkDeletable()?e("button",{on:{click:t.bulkDelete}},[t._v(t._s(t.$trans("listing.dropdown.delete")))]):t._e(),t.bulkRestorable()?e("button",{on:{click:t.bulkRestore}},[t._v(t._s(t.$trans("listing.dropdown.restore")))]):t._e(),t.bulkDestroyable()?e("button",{on:{click:t.bulkDestroy}},[t._v(t._s(t.$trans("listing.dropdown.destroy")))]):t._e()])])])],1)],1),e("a17-button",{attrs:{variant:"ghost"},on:{click:t.clearBulkSelect}},[t._v(t._s(t.$trans("listing.bulk-clear")))])],1)]):t._e()])},Vt=[];const jt={name:"A17BulkEditor",computed:{...l({bulkIds:t=>t.datatable.bulk,bulkStatus:t=>t.datatable.data.filter(a=>t.datatable.bulk.includes(a.id)).reduce((a,e)=>({featured:a.featured&&(e.featured||!1),canFeature:a.canFeature&&e.hasOwnProperty("featured"),published:a.published&&(e.published||!1),canPublish:a.canPublish&&e.hasOwnProperty("published"),deleted:a.deleted&&(e.deleted||!1),canDelete:a.canDelete&&e.delete!==null,canDestroy:a.canDestroy&&e.hasOwnProperty("destroyable")}),{featured:!0,canFeature:!0,published:!0,canPublish:!0,deleted:!0,canDelete:!0,canDestroy:!0})})},methods:{bulkPublishable:function(t=!1){return window.TWILL.CMS_URLS.bulkPublish!==""&&this.bulkStatus.canPublish&&(t?this.bulkStatus.published:!this.bulkStatus.published)&&!this.bulkStatus.deleted},bulkFeaturable:function(t=!1){return window.TWILL.CMS_URLS.bulkFeature!==""&&this.bulkStatus.canFeature&&(t?this.bulkStatus.featured:!this.bulkStatus.featured)&&!this.bulkStatus.deleted},bulkDeletable:function(){return window.TWILL.CMS_URLS.bulkDelete!==""&&!this.bulkStatus.deleted&&this.bulkStatus.canDelete},bulkRestorable:function(){return window.TWILL.CMS_URLS.bulkRestore!==""&&this.bulkStatus.deleted},bulkDestroyable:function(){return window.TWILL.CMS_URLS.bulkDestroy!==""&&this.bulkStatus.deleted&&this.bulkStatus.canDestroy},clearBulkSelect:function(){this.$store.commit(d.REPLACE_DATATABLE_BULK,[])},bulkPublish:function(){this.$store.dispatch(i.BULK_PUBLISH,{toPublish:!0})},bulkUnpublish:function(){this.$store.dispatch(i.BULK_PUBLISH,{toPublish:!1})},bulkFeature:function(){this.$store.dispatch(i.BULK_FEATURE,{toFeature:!0})},bulkUnFeature:function(){this.$store.dispatch(i.BULK_FEATURE,{toFeature:!1})},bulkExport:function(){this.$store.dispatch(i.BULK_EXPORT)},bulkDelete:function(){this.$root.$refs.warningDeleteRow?this.$root.$refs.warningDeleteRow.open(()=>{this.$store.dispatch(i.BULK_DELETE)}):this.$store.dispatch(i.BULK_DELETE)},bulkRestore:function(){this.$store.dispatch(i.BULK_RESTORE)},bulkDestroy:function(){this.$root.$refs.warningDestroyRow?this.$root.$refs.warningDestroyRow.open(()=>{this.$store.dispatch(i.BULK_DESTROY)}):this.$store.dispatch(i.BULK_DESTROY)}}},A={};var Ht=s(jt,zt,Vt,!1,Yt,"8de8d25c",null,null);function Yt(t){for(let a in A)this[a]=A[a]}var Xt=function(){return Ht.exports}(),Jt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a17-modal",{ref:"modal",staticClass:"modal--form",attrs:{title:t.modalTitle,forceClose:!0}},[e("form",{attrs:{action:t.actionForm},on:{submit:function(n){return n.preventDefault(),t.submit(n)}}},[t._t("default"),e("a17-modal-validation",{attrs:{mode:t.mode,"is-disable":t.createMode,"active-publish-state":t.withPublicationToggle,"is-publish":t.published,"published-name":"published",textEnabled:t.publishedLabel,textDisabled:t.draftLabel}})],2)])},qt=[];const Qt={name:"A17ModalCreate",mixins:[H],props:{formCreate:{type:String,default:"#"},publishedLabel:{type:String,default(){return this.$trans("main.published","Live")}},draftLabel:{type:String,default(){return this.$trans("main.draft","Draft")}}},components:{"a17-modal-validation":Y},computed:{createMode:function(){return this.mode==="create"},actionForm:function(){return this.createMode?this.formCreate:this.action},modalTitle:function(){return this.createMode?this.$trans("modal.create.title","Add new"):this.$trans("modal.update.title","Update")},published:function(){return!this.createMode&&!!this.fieldValueByName("published")},withPublicationToggle:function(){return this.columns.find(t=>t.name==="published")!==void 0},...l({action:t=>t.modalEdition.action,mode:t=>t.modalEdition.mode,columns:t=>t.datatable.columns}),...$(["fieldValueByName"])},methods:{open:function(){this.createMode&&this.$store.commit(P.RESET_LANGUAGES),this.$refs.modal.open()},submit:function(){if(this.isSubmitPrevented){this.shouldRetrySubmitWhenAllowed=!0;return}if(this._isSubmitting)return;this._isSubmitting=!0;const t=this;this.$store.commit(p.UPDATE_FORM_LOADING,!0);const a=document.activeElement.name;this.$nextTick(function(){this.$store.dispatch(i.UPDATE_FORM_IN_LISTING,{endpoint:this.actionForm,method:this.mode==="create"?"post":"put",redirect:a!=="create-another"}).then(()=>{t.$refs.modal&&t.$refs.modal.close(),t.$nextTick(function(){a==="create-another"&&t.$refs.modal&&t.$refs.modal.open(),this.mode==="create"&&this.$store.commit(d.UPDATE_DATATABLE_PAGE,1),this.$store.commit(p.REMOVE_FORM_FIELD,"published"),this.$emit("reload")})},e=>{t.$store.commit(U.SET_NOTIF,{message:"Your submission could not be validated, please fix and retry",variant:"error"})}).finally(()=>{t.$nextTick(function(){t._isSubmitting=!1})})})}}},D={};var Zt=s(Qt,Jt,qt,!1,te,null,null,null);function te(t){for(let a in D)this[a]=D[a]}var ee=function(){return Zt.exports}();const ae={action:"#",mode:"create"},ne={},de={[f.UPDATE_MODAL_ACTION](t,a){t.action=a},[f.UPDATE_MODAL_MODE](t,a){t.mode=a}};var ie={state:ae,getters:ne,mutations:de};m.use(F);m.use(O);r.registerModule("datatable",q);r.registerModule("language",V);r.registerModule("form",N);r.registerModule("modalEdition",ie);r.registerModule("attributes",X);window.TWILL.vm=window.vm=new m({store:r,el:"#app",components:{"a17-filter":W,"a17-table-filters":Kt,"a17-datatable":gt,"a17-nested-datatable":Ut,"a17-bulk":Xt,"a17-langmanager":J,"a17-modal-create":ee},mixins:[z],computed:{hasBulkIds:function(){return this.bulkIds.length>0},...l({localStorageKey:t=>t.datatable.localStorageKey,baseUrl:t=>t.datatable.baseUrl,bulkIds:t=>t.datatable.bulk})},methods:{create:function(){this.$refs.editionModal&&(this.$store.commit(f.UPDATE_MODAL_ACTION,""),this.$store.commit(f.UPDATE_MODAL_MODE,"create"),this.$store.commit(p.EMPTY_FORM_FIELDS),this.$refs.editionModal.open())},reloadDatas:function(){this.$store.dispatch(i.GET_DATATABLE)},clearFiltersAndReloadDatas:function(){this.$store.commit(d.UPDATE_DATATABLE_PAGE,1),this.$store.commit(d.CLEAR_DATATABLE_FILTER),Object.keys(this.$refs).filter(t=>t.indexOf("filterDropdown[")===0).map(t=>{this.$refs[t].updateValue()}),this.reloadDatas()},filterListing:function(t){const a=this;this.$store.commit(d.UPDATE_DATATABLE_PAGE,1),this.$store.commit(d.UPDATE_DATATABLE_FILTER,t||{search:""}),this.$nextTick(function(){a.reloadDatas()})}},mounted:function(){window.TWILL.openCreate&&this.create()},created:function(){G();let t=!1;const a=w(this.localStorageKey+"_page-offset");a&&(this.$store.commit(d.UPDATE_DATATABLE_OFFSET,parseInt(a)),t=!0);const e=w(this.localStorageKey+"_columns-visible");e&&(this.$store.commit(d.UPDATE_DATATABLE_VISIBLITY,JSON.parse(e)),t=!0),t&&this.reloadDatas()}});document.addEventListener("DOMContentLoaded",K);
