import{m as c,b as C,c as d,L as P,F as D,N as l,l as M,n as i,p,q as R}from"./form.af977733.js";import{D as f}from"./language.bdacb39e.js";const A="updateModalAction",k="updateModalMode";var u={UPDATE_MODAL_ACTION:A,UPDATE_MODAL_MODE:k},la={props:{nested:{type:Boolean,default:!1},bulkeditable:{type:Boolean,default:!0},emptyMessage:{type:String,default:""}},computed:{rows:{get(){return this.$store.state.datatable.data},set(t){const a=this.rows.length!==t.length;this.$store.commit(f.UPDATE_DATATABLE_DATA,t),this.saveNewTree(a)}},isEmpty:function(){return this.rows.length<=0},isEmptyDatable:function(){return{"datatable__table--empty":this.isEmpty}},...c({columns:t=>t.datatable.columns}),...C(["visibleColumns","hideableColumns","visibleColumnsNames"])},methods:{saveNewTree:function(t){const e=(t?!0:this.nested)?d.SET_DATATABLE_NESTED:d.SET_DATATABLE,n=()=>{this.$store.commit(f.UPDATE_DATATABLE_TRACKER,0),this.$store.dispatch(e)};t?(this.$store.commit(f.UPDATE_DATATABLE_TRACKER,1),this.updateTracker>=2&&n()):n()}}},ca={props:{index:{type:Number,default:0},row:{type:Object,default:function(){return{}}},columns:{type:Array,default:function(){return[]}}},computed:{editInModal:function(){return this.row.hasOwnProperty("editInModal")?this.row.editInModal:!1},editUrl:function(){return this.row.hasOwnProperty("edit")?this.row.edit:"#"},updateUrl:function(){return this.row.updateUrl?this.row.updateUrl:"#"},...c({bulkIds:t=>t.datatable.bulk})},methods:{currentComponent(t){var a;return r+((a=t.specificType)!=null?a:t.name.toLowerCase())},currentComponentProps(t){const a={col:t||{},row:this.row,editUrl:this.editUrl,editInModal:Boolean(this.editInModal)};if(!t)return a;switch(t.name){case"bulk":a.value=this.row.id,a.initialValue=this.bulkIds;break;case"languages":a.languages=this.row.hasOwnProperty("languages")?this.row.languages:[],a.editUrl=this.editUrl;break;case"publish_start_date":a.startDate="",a.endDate="";break}return a},editInPlace:function(t){if(t.lang){const a=t.lang;this.$store.commit(P.UPDATE_LANG,a.value)}if(this.editInModal){const a=this.editInModal;this.$store.commit(u.UPDATE_MODAL_MODE,"update"),this.$store.commit(u.UPDATE_MODAL_ACTION,this.updateUrl),this.$store.commit(D.UPDATE_FORM_LOADING,!0),this.$store.dispatch(d.REPLACE_FORM,a).then(()=>{this.$nextTick(function(){this.$root.$refs.editionModal&&this.$root.$refs.editionModal.open()})},e=>{this.$store.commit(l.SET_NOTIF,{message:"Your content can not be edited, please retry",variant:"error"})})}},cellClasses:function(t,a){return{[a+"--icon"]:t.name==="featured"||t.name==="published",[a+"--bulk"]:t.name==="bulk",[a+"--thumb"]:t.name==="thumbnail",[a+"--draggable"]:t.name==="draggable",[a+"--languages"]:t.name==="languages",[a+"--nested"]:t.name==="nested",[a+"--nested--parent"]:t.name==="nested"&&this.nestedDepth===0,[a+"--name"]:t.name==="name"}},isSpecificColumn:function(t){var a;return Xt.includes((a=t.specificType)!=null?a:t.name)},tableCellUpdate:function(t){switch(t.col){case"published":this.togglePublish(t.row);break;case"bulk":this.toggleBulk(t.row);break;case"featured":this.toggleFeatured(t.row);break}},toggleFeatured:function(t){t.hasOwnProperty("deleted")?this.$store.commit(l.SET_NOTIF,{message:"You can\u2019t feature/unfeature a deleted item, please restore it first.",variant:"error"}):this.$store.dispatch(d.TOGGLE_FEATURE,t)},toggleBulk:function(t){this.$store.commit(f.UPDATE_DATATABLE_BULK,t.id)},togglePublish:function(t){t.hasOwnProperty("deleted")?this.$store.commit(l.SET_NOTIF,{message:"You can\u2019t publish/unpublish a deleted item, please restore it first.",variant:"error"}):this.$store.dispatch(d.TOGGLE_PUBLISH,t)},restoreRow:function(t){this.$store.dispatch(d.RESTORE_ROW,t)},destroyRow:function(t){this.$root.$refs.warningDestroyRow?this.$root.$refs.warningDestroyRow.open(()=>{this.$store.dispatch(d.DESTROY_ROW,t)}):this.$store.dispatch(d.DESTROY_ROW,t)},deleteRow:function(t){this.$root.$refs.warningDeleteRow?this.$root.$refs.warningDeleteRow.open(()=>{this.$store.dispatch(d.DELETE_ROW,t)}):this.$store.dispatch(d.DELETE_ROW,t)},duplicateRow:function(t){this.$store.dispatch(d.DUPLICATE_ROW,t)}}},pa={filters:M,computed:{...c({currentLocale:t=>t.language.active})},methods:{formatPermalink:function(t){const a=this.$refs.permalink;if(!!a&&t){let e="";t.value&&typeof t.value=="string"?e=t.value:typeof t=="string"&&(e=t);const n=this.$options.filters.slugify(e),s={name:a.attributes?a.attributes.name:a.name,value:n};t.locale?s.locale=t.locale:s.locale=this.currentLocale.value,this.$store.commit(D.UPDATE_FORM_FIELD,s)}}}},o={props:{col:{type:Object,default:()=>{}},row:{type:Object,default:()=>{}},editUrl:{type:String,default:"#"},editInModal:{type:Boolean,default:!1}},computed:{colName:function(){return this.col.hasOwnProperty("name")?this.col.name:""}},methods:{update:function(){this.$emit("update",{row:this.row,col:this.colName})},preventEditInPlace:function(t){this.editInModal&&t.preventDefault(),this.editInPlace()},editInPlace:function(t,a){this.$emit("editInPlace",{event:t,lang:a})},restoreRow:function(){this.$emit("restoreRow",this.row)},destroyRow:function(){this.$emit("destroyRow",this.row)},deleteRow:function(){this.$emit("deleteRow",this.row)},duplicateRow:function(){this.$emit("duplicateRow",this.row)}}},E=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a17-dropdown",{ref:"rowSetupDropdown",attrs:{position:"bottom-right",fixed:!0}},[e("a17-button",{attrs:{variant:"icon"},on:{click:function(n){return t.$refs.rowSetupDropdown.toggle()}}},[e("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"more-dots"}})]),e("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},[t.row.hasOwnProperty("permalink")?e("a",{attrs:{href:t.row.permalink,target:"_blank"}},[t._v("View permalink")]):t._e(),t.row.hasOwnProperty("edit")&&!t.row.hasOwnProperty("deleted")&&t.row.edit?e("a",{attrs:{href:t.editUrl},on:{click:function(n){return t.preventEditInPlace(n)}}},[t._v(t._s(t.$trans("listing.dropdown.edit","Edit")))]):t._e(),t.row.hasOwnProperty("published")&&!t.row.hasOwnProperty("deleted")?e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.update("published")}}},[t._v(t._s(t.row.published?t.$trans("listing.dropdown.unpublish","Unpublish"):t.$trans("listing.dropdown.publish","Publish")))]):t._e(),t.row.hasOwnProperty("featured")&&!t.row.hasOwnProperty("deleted")?e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.update("featured")}}},[t._v(t._s(t.row.featured?t.$trans("listing.dropdown.unfeature","Unfeature"):t.$trans("listing.dropdown.feature","Feature")))]):t._e(),t.row.duplicate&&!t.row.hasOwnProperty("deleted")?e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.duplicateRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.duplicate","Duplicate")))]):t._e(),t.row.hasOwnProperty("deleted")?e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.restoreRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.restore","Restore")))]):t._e(),t.row.hasOwnProperty("deleted")&&t.row.hasOwnProperty("destroyable")?e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.destroyRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.destroy","Destroy")))]):t.row.delete&&!t.row.hasOwnProperty("deleted")?e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.deleteRow(n)}}},[t._v(t._s(t.$trans("listing.dropdown.delete","Delete")))]):t._e()])],1)},B=[];const O={name:"TableCellActions",mixins:[o],methods:{update:function(t){this.$emit("update",{row:this.row,col:t})}}},m={};var N=i(O,E,B,!1,L,"ba47528a",null,null);function L(t){for(let a in m)this[a]=m[a]}var U=function(){return N.exports}(),F=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.toggleBulk(n)}}},[e("a17-checkbox",{attrs:{name:"bulkEdit",value:t.value,initialValue:t.initialValue}})],1)},S=[];const j={name:"A17TableCellBulk",mixins:[o],components:{},props:{value:{type:Number,required:!0},initialValue:{type:Array,required:!0}},methods:{toggleBulk:function(){this.update()}}},w={};var G=i(j,F,S,!1,W,"838e9446",null,null);function W(t){for(let a in w)this[a]=w[a]}var q=function(){return G.exports}(),H=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("span",[t.formatDateLabel.length>0?e("span",{staticClass:"tablecell__datePub",class:{"s--expired":t.formatDateLabel===t.textExpired}},[t._v(" "+t._s(t._f("formatDatatableDate")(t.startDate))+" "),t.endDate?[t._v("- "+t._s(t._f("formatDatatableDate")(t.endDate)))]:t._e(),e("br"),e("span",[t._v(t._s(t.formatDateLabel))])],2):e("span",[t.startDate?[t._v(" "+t._s(t._f("formatDatatableDate")(t.startDate))+" ")]:[t._v(" \u2014 ")]],2)])},Y=[];const K={name:"A17TableCellDates",mixins:[o],data(){return{textExpired:this.$trans("publisher.expired"),textScheduled:this.$trans("publisher.scheduled")}},computed:{formatDateLabel:function(){let t="";const a=p(this.startDate,new Date),e=this.endDate?p(this.endDate,new Date):1;return this.startDate&&e<0?t=this.textExpired:a>0&&(t=this.textScheduled),t},startDate:function(){return this.row.hasOwnProperty("publish_start_date")?this.row.publish_start_date:""},endDate:function(){return this.row.hasOwnProperty("publish_end_date")?this.row.publish_end_date:""}},filters:M},h={};var Q=i(K,H,Y,!1,z,"602b7452",null,null);function z(t){for(let a in h)this[a]=h[a]}var J=function(){return Q.exports}(),X=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.row.hasOwnProperty("featured")?e("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"tablecell__feature",class:{"tablecell__feature--active":t.row[t.colName]},attrs:{"data-tooltip-title":t.row.featured?"Unfeature":"Feature"},on:{click:function(n){return n.preventDefault(),t.toggleFeatured(n)}}},[e("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"star-feature_active"}}),e("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"star-feature"}})]):t._e()},Z=[];const V={name:"A17TableCellFeatured",mixins:[o],methods:{toggleFeatured:function(){this.update()}}},_={};var tt=i(V,X,Z,!1,at,"83779ce6",null,null);function at(t){for(let a in _)this[a]=_[a]}var et=function(){return tt.exports}(),nt=function(t,a){var e=a._c;return e("span",{staticClass:"tablecell__handle"})},it=[];const ot={name:"A17TableCellDraggable",mixins:[o]},x={};var rt=i(ot,nt,it,!0,dt,"37de210b",null,null);function dt(t){for(let a in x)this[a]=x[a]}var st=function(){return rt.exports}(),ft=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("span",[t._l(t.displayedLanguages,function(n){return e("a",{key:n.value,staticClass:"tag tag--disabled",class:{"tag--enabled":n.published},attrs:{href:t.editWithLanguage(n)},on:{click:function(s){return t.editInPlace(s,n)}}},[t._v(" "+t._s(n.shortlabel)+" ")])}),t.languages.length>4?e("a",{staticClass:"more__languages f--small",attrs:{href:t.editWithLanguage(t.languages[0])},on:{click:function(n){return t.editInPlace(n,t.languages[0])}}},[t._v(" + "+t._s(t.languages.length-4)+" more ")]):t._e()],2)},lt=[];const ct={name:"A17TableCellLanguages",mixins:[o],props:{languages:{type:Array,default:function(){return[]}}},computed:{displayedLanguages:function(){return this.languages.slice(0,4)}},methods:{editWithLanguage:function(t){const a={};return a.lang=t.value,this.editWithQuery(a)},editWithQuery:function(t){const a=[];for(const n in t)t.hasOwnProperty(n)&&a.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));const e=a.length?"?"+a.join("&"):"";return this.editUrl!=="#"?this.editUrl+e:this.editUrl},editInPlace:function(t,a){this.$emit("editInPlace",t,a)}}},g={};var pt=i(ct,ft,lt,!1,ut,"a31d909c",null,null);function ut(t){for(let a in g)this[a]=g[a]}var mt=function(){return pt.exports}(),wt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.row.hasOwnProperty("published")?e("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"tablecell__pubstate",class:{"tablecell__pubstate--live":t.row[t.colName]},attrs:{"data-tooltip-title":t.row.published?"Unpublish":"Publish"},on:{click:function(n){return n.preventDefault(),t.togglePublish(n)}}}):t._e()},ht=[];const _t={name:"A17TableCellPublished",mixins:[o],methods:{togglePublish:function(){this.update()}}},b={};var xt=i(_t,wt,ht,!1,gt,"4bcef49c",null,null);function gt(t){for(let a in b)this[a]=b[a]}var bt=function(){return xt.exports}(),vt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return!t.row.hasOwnProperty("deleted")&&t.row.edit?e("a",{staticClass:"tablecell__name",attrs:{href:t.editUrl},on:{click:function(n){return t.preventEditInPlace(n)}}},[e("span",{staticClass:"f--link-underlined--o"},[t._v(t._s(t.row[t.colName]))])]):e("span",[t._v(t._s(t.row[t.colName]))])},yt=[];const It={name:"A1TableCellName",mixins:[o]},v={};var $t=i(It,vt,yt,!1,Tt,"49d31086",null,null);function Tt(t){for(let a in v)this[a]=v[a]}var Dt=function(){return $t.exports}(),Mt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("span",{staticClass:"tablecell__raw",domProps:{innerHTML:t._s(t.row[t.colName])}})},Ct=[];const Pt={name:"A1TableCellHtml",mixins:[o]},y={};var Rt=i(Pt,Mt,Ct,!1,At,null,null,null);function At(t){for(let a in y)this[a]=y[a]}var kt=function(){return Rt.exports}(),Et=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.colName==="name"?e("a17-table-cell-name",t._b({on:{update:t.update,editInPlace:t.editInPlace}},"a17-table-cell-name",t.childProps,!1)):t.col.hasOwnProperty("html")?e("a17-table-cell-html",t._b({on:{update:t.update,editInPlace:t.editInPlace}},"a17-table-cell-html",t.childProps,!1)):e("span",[t._v(t._s(t.row[t.colName]))])},Bt=[];const Ot={name:"A17TableCellGeneric",mixins:[o],computed:{childProps:function(){return this.$props}},components:{"a17-table-cell-name":Dt,"a17-table-cell-html":kt}},I={};var Nt=i(Ot,Et,Bt,!1,Lt,"91f81956",null,null);function Lt(t){for(let a in I)this[a]=I[a]}var Ut=function(){return Nt.exports}(),Ft=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("span",{staticClass:"tablecell__nested-depth",style:t.cellWidth})},St=[];const jt={name:"A17TableCellNested",mixins:[o],props:{depth:{type:Number,default:0},offset:{type:Number,default:0}},computed:{cellWidth(){return this.depth>0?{width:this.depth*80-20-this.offset+"px"}:""}}},$={};var Gt=i(jt,Ft,St,!1,Wt,"7153bbba",null,null);function Wt(t){for(let a in $)this[a]=$[a]}var qt=function(){return Gt.exports}(),Ht=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{class:t.getThumbClasses},[e("a",{attrs:{href:t.row.hasOwnProperty("deleted")?!1:t.editUrl},on:{click:function(n){t.row.hasOwnProperty("deleted")||t.preventEditInPlace(n)}}},[t.col.variation==="rounded"?[e("a17-avatar",{attrs:{name:t.rowTitle,thumbnail:t.row[t.colName]}})]:[e("img",{attrs:{src:t.row[t.colName]}})]],2)])},Yt=[];const Kt={name:"A17TableCellThumbNail",mixins:[o],components:{"a17-avatar":R},computed:{rowTitle(){var t,a;return(a=(t=this.row.name)!=null?t:this.row.title.replace(/<[^>]*>?/gm,""))!=null?a:""},getThumbClasses(){return["tablecell__thumb",this.col.variation?`tablecell__thumb--${this.col.variation}`:""]}}},T={};var Qt=i(Kt,Ht,Yt,!1,zt,"6360cc5f",null,null);function zt(t){for(let a in T)this[a]=T[a]}var Jt=function(){return Qt.exports}();const Xt=["draggable","bulk","languages","featured","published","thumbnail","publish_start_date","nested"],r="a17-table-cell-",Zt=U,Vt=q,ta=J,aa=et,ea=st,na=mt,ia=bt,oa=Ut,ra=qt,da=Jt;var ua={[r+"actions"]:Zt,[r+"bulk"]:Vt,[r+"publish_start_date"]:ta,[r+"featured"]:aa,[r+"draggable"]:ea,[r+"generic"]:oa,[r+"languages"]:na,[r+"published"]:ia,[r+"nested"]:ra,[r+"thumbnail"]:da};export{ca as D,pa as F,u as M,na as T,ua as a,la as b};
